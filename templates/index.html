<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>QRFile Share – by zerquix</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">
    <h1>📤 QRFile Share</h1>
    <p>Kirim file lokal via jaringan Wi-Fi ke HP lewat QR Code.</p>

    <form id="uploadForm" method="POST" enctype="multipart/form-data">
      <input type="file" name="file" required>
      <button type="submit">Unggah & Buat QR</button>
    </form>

    <div id="loading" class="hidden">⏳ Uploading lucu...</div>

    <div id="result" class="hidden">
      <h2>✅ QR Code Siap</h2>
      <img id="qrImage" src="" alt="QR Code" width="200">
      <p><a id="downloadLink" href="#" download>📥 Klik di sini jika QR gagal</a></p>
    </div>

    <footer>
      <p>© 2025 <a href="https://github.com/zerquix/qrfile-share" target="_blank">zerquix</a></p>
    </footer>
  </div>

  <script>
    const form = document.getElementById('uploadForm');
    const loading = document.getElementById('loading');
    const result = document.getElementById('result');
    const qrImage = document.getElementById('qrImage');
    const downloadLink = document.getElementById('downloadLink');

    form.addEventListener('submit', function (e) {
      e.preventDefault();
      const file = form.querySelector('input[type="file"]').files[0];
      if (!file) return;

      const formData = new FormData();
      formData.append('file', file);

      loading.classList.remove('hidden');
      result.classList.add('hidden');

      fetch('/upload', {
        method: 'POST',
        body: formData
      })
        .then(res => res.json())
        .then(data => {
          qrImage.src = data.qr_url;
          downloadLink.href = data.download_url;
          result.classList.remove('hidden');
        })
        .catch(err => {
          alert('Upload gagal.');
        })
        .finally(() => {
          loading.classList.add('hidden');
          form.reset();
        });
    });
  </script>
</body>
</html>
